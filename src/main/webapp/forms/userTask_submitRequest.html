<form name="customForm" role="form">

  <script cam-script type="text/form-script">
    camForm.on('form-loaded', function() {
      // fetch the variable named 'fullPrice'
      camForm.variableManager.fetchVariable('fullPrice');
      // fetch the variable named 'mealForm'
      camForm.variableManager.fetchVariable('mealForm');
      // fetch the variable named 'simpleUser'
      camForm.variableManager.fetchVariable('simpleUser');
    });

    camForm.on('variables-fetched', function() {
      // after the variables are fetched, bind the value of mealForm to a angular
      // scope value such that the form can work on it
      $scope.fullPrice = camForm.variableManager.variable('fullPrice').value;
      // after the variables are fetched, bind the value of mealForm to a angular
      // scope value such that the form can work on it
      $scope.mealForm = camForm.variableManager.variable('mealForm').value;
      // after the variables are fetched, bind the value of simpleUser to a angular
      // scope value such that the form can work on it
      $scope.simpleUser = camForm.variableManager.variable('simpleUser').value;
    });

    camForm.on('submit', function() {
      // remove '$$hashKey' properties from meal objects
      angular.forEach($scope.mealForm.mealList, function(meal) {
        delete meal.$$hashKey;
        angular.forEach(meal.ingredientList, function(ing) {
          delete ing.$$hashKey;
        });
      });
    });

  </script>
  <div>
    <h3>Submit Request</h3>
    <p>On submit, we will buy the goods for you, and deliver it to the following user</p>

    <h4>Goods:</h4>
    <div ng-repeat="meal in mealForm.mealList">
      <div ng-repeat="ingredient in meal.ingredientList">
        <div>
          name: {{ingredient.name}}<br> amount: {{ingredient.amount}}<br> price: {{ingredient.priceInCent}}<br>
        </div>
        <br>
      </div>
    </div>
    We will debit the following sum: <strong>{{fullPrice}}</strong><br>

    <h4>Recipient</h4>
    <div>
      E-Mail: {{simpleUser.email}}<br>
      Name: {{simpleUser.firstName}} {{simpleUser.lastName}}<br>
      Address: {{simpleUser.address}}    
    </div>
    
    <div class="form-group">
      <label>Order with costs?</label> <select cam-variable-name="isOrdered" cam-variable-type="Boolean">
        <option value="true">Submit</option>
        <option value="false">Nope</option>
      </select>
    </div>
  </div>
</form>